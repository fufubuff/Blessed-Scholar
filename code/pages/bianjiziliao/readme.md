# 用户修改资料页面

## 描述（头像和昵称修改有问题）

本页面用于用户修改个人设置，包括头像、昵称、性别、生日、报考院校、报考专业、考研年份和个性签名等信息。用户可以通过此页面更新其个人资料并保存更改。

## 页面功能

- **修改头像**：用户可以查看当前头像并选择更改。
- **修改昵称**：用户可以点击昵称进行修改，并跳转至昵称编辑页面。
- **设置性别**：用户可以选择性别选项（男、女、其他），选中的性别会被标记（加粗字体颜色变成红色）。
- **个人信息输入**：用户可以输入或修改生日、报考院校、报考专业和个性签名。
- **考研年份选择**：用户可以点击当前年份以跳转到考研年份编辑页面。
- **保存按钮**：用户点击保存按钮可以保存所有更改的信息。

## 数据获取与更新

- **用户信息初始化**: 最开始注册和登录时输入的部分个人信息会通过云函数上传到users的相应字段。
- **用户信息获取**：通过 `fetchUserInfo` 方法从云函数获取当前用户的个人信息，并在本地存储中更新。
- **信息保存**：点击保存按钮时，通过 `saveUserInfo` 方法将用户更改的信息上传到云函数进行保存。

## 相关云函数

- **getUserInfo 云函数**：用于获取用户的个人信息。
  
  **输入参数**：
  - `account`：用户的账号信息。

  **输出结果**：
  - `success`：操作是否成功。
  - `data`：返回的用户信息。
  
- **updateUserInfo 云函数**：用于更新用户的个人信息。

  **输入参数**：
  - `user`：包含用户的所有信息（头像、昵称、性别等）。

  **输出结果**：
  - `success`：操作是否成功。
  - `message`：返回的信息，用于提示用户。

## 页面交互逻辑

1. **获取用户信息**：
   - 页面加载时调用 `fetchUserInfo` 方法从云函数获取用户的个人信息。

2. **修改昵称**：
   - 用户点击昵称文本时，触发 `navigateToNicknameEdit` 方法，跳转到昵称编辑页面。

3. **设置性别**：
   - 用户选择性别选项时，调用 `setGender` 方法更新用户的性别状态。

4. **考研年份选择**：
   - 用户点击年份文本时，触发 `navigateToYearEdit` 方法，跳转到考研年份编辑页面。
   
5. **其他信息输入**：
   - 其他信息可以直接在编辑资料页面输入进行修改，每种信息都是输入框，可以输入保存到云数据库中。

6. **保存用户信息**：
   - 点击保存按钮时，调用 `saveUserInfo` 方法，将更新的信息保存到云函数。

7. **更新事件监听**：
   - 使用 `$on` 方法监听 `yearUpdated` 和 `nicknameUpdated` 事件，以实时更新用户信息。

## 注意事项

- **输入字段验证**：确保用户输入的信息符合系统要求（如生日格式、专业名称等）。
- **头像上传功能**：该页面可以扩展头像上传的功能，以允许用户选择新头像。

## 小结

该用户设置页面实现了多项用户个人信息的修改功能，操作简便且交互友好，用户在修改信息后能够及时保存和反馈。
