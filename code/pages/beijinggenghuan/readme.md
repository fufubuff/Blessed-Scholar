# 背景更换页面

## 描述(还不能实现，现在背景默认是background.png)

本页面最开始默认背景是/static/background.png，同时允许用户更换应用的背景图片，用户可以通过选择相册来设置新的背景。更换背景功能提升了用户的个性化体验，使用户可以根据自己的喜好自定义应用的视觉效果。

## 页面功能

- **更换背景按钮**：位于页面顶部，用户点击后可以选择新的背景图片。按钮上显示“更换背景”文字和一个相机图标，提示用户可以更换背景。
  
- **背景图片显示**：页面主要区域用于展示当前的背景图片。默认情况下显示应用的默认背景图片，用户更换背景后会显示用户选择的图片。

## 数据获取与更新

- **本地存储读取**：在页面加载时，会从本地存储中读取之前保存的背景图片路径（如果有），并将其设置为当前背景。

- **图片选择与上传**：
  - 用户点击“更换背景”按钮后，调用 `uni.chooseImage` 方法打开图片选择器，用户可以从相册中选择图片或使用相机拍摄照片。
  - 选择图片后，获取到本地图片的临时路径 `tempFilePaths`。
  - 生成云存储路径 `cloudPath`，包括时间戳和原始文件名，确保文件名的唯一性。
  - 使用 `uniCloud.uploadFile` 方法将图片上传到云存储。
  - 上传成功后，获取到文件的 `fileID`，并将其设置为新的背景图片路径。
  - 将新的背景图片路径保存到本地存储，以便下次加载时使用。

## 相关云函数

- **图片上传功能**：使用了 `uniCloud.uploadFile` 接口上传图片到云存储，无需额外编写云函数。

- **本页面未涉及自定义的云函数**。

## 页面交互逻辑

1. **用户点击“更换背景”按钮**：
   - 触发 `chooseImage` 方法。
   - 打开图片选择器，用户选择图片。

2. **图片选择成功后**：
   - 检查是否选择了图片，如果未选择，提示用户“未选择图片”。
   - 获取到本地图片路径后，生成云存储路径并上传图片。
   - 上传成功后，获取 `fileID`，将其设置为当前背景图片，并保存到本地存储。
   - 提示用户“背景更新成功”。

3. **页面加载时**：
   - 在 `mounted` 钩子中，从本地存储读取背景图片路径。
   - 如果存在已保存的背景图片，设置为当前背景。

4. **异常处理**：
   - 在任何一步出现错误（如未选择图片、上传失败等），都会捕获异常并提示用户相应的错误信息。

## 注意事项

- **权限问题**：使用图片选择器需要用户授权访问相册或相机，需做好权限请求和异常处理。

- **网络问题**：上传图片依赖网络连接，需要处理网络异常情况下的错误提示。

- **图片大小限制**：可能需要考虑限制上传图片的大小，以免影响应用性能或超出云存储限制。

## 小结

该页面通过提供更换背景图片的功能，增强了应用的个性化和用户体验。用户可以方便地更改应用的背景，操作简单直观。通过将背景图片路径保存在本地存储，确保了用户设置的背景能够持久化。整个过程包含了图片选择、上传、存储和显示等功能模块，结合了前端交互和云存储服务。
